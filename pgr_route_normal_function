--DROP FUNCTION routing.get_route(geometry, geometry);

CREATE OR REPLACE FUNCTION routing.get_route(
    IN originpoint geometry,
    IN destinationpoint geometry,
    OUT seq integer,
    OUT gid integer,
    OUT name text,
    OUT heading double precision,
    OUT cost double precision,
    OUT geom geometry
) RETURNS SETOF record AS
$BODY$
	DECLARE
		query text;
		query_query text;
		originid integer;
		destinationid integer;
	BEGIN
		RAISE NOTICE 'Origin Point: %', originpoint;
		RAISE NOTICE 'Destination Point: %', destinationpoint;
		
		EXECUTE 'SELECT routing.get_waypoint($1)' INTO originid USING originpoint;
		EXECUTE 'SELECT routing.get_waypoint($1)' INTO destinationid USING destinationpoint;

		RAISE NOTICE 'Origin ID: %', originid;
		RAISE NOTICE 'Destination ID: %', destinationid;
	END;
$BODY$
LANGUAGE 'plpgsql' VOLATILE STRICT;
